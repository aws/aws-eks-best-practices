name: Prevent SELinux containers from setting a role
uniqueName: EKS_INVALID_SELINUXOPTIONS_ROLE_VALUE
enabledByDefault: false
documentationUrl: "https://hub.datree.io/built-in-rules/prevent-selinux-containers-role"
messageOnFailure: "Invalid key `role` - refrain from setting this key to prevent potential access to the host filesystem"
category: EKS
complexity: easy
impact: Setting an SELinux role may grant attackers access to sensitive components
schema:
  definitions:
    selinuxUserPattern:
      properties:
        securityContext:
          properties:
            seLinuxOptions:
              not:
                required:
                  - role
  allOf:
    - $ref: "#/definitions/selinuxUserPattern"
  additionalProperties:
    $ref: "#"
  items:
    $ref: "#"
