name: Ensure each container fully utilizes CPU with no limitations
uniqueName: EKS_INVALID_CPU_LIMIT
enabledByDefault: false
documentationUrl: "https://hub.datree.io/built-in-rules/ensure-no-cpu-limit"
messageOnFailure: "Invalid key `limits.cpu` - refrain from setting a CPU limit to better utilize the CPU and prevent starvation"
category: EKS
complexity: easy
impact: Setting a CPU limit may cause starvation and sub-optimal utilization of the CPU
schema:
  definitions:
    cpuLimitPattern:
      properties:
        spec:
          properties:
            containers:
              type: array
              items:
                properties:
                  resources:
                    properties:
                      limits:
                        type: object
                        not:
                          required:
                            - cpu
  allOf:
    - $ref: "#/definitions/cpuLimitPattern"
  additionalProperties:
    $ref: "#"
  items:
    $ref: "#"
