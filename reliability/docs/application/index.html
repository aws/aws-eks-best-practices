
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.aws.amazon.com/eks/latest/best-practices/application.html">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../controlplane/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Applications - EKS Best Practices Guides</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-VQGL8B2FH8"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-VQGL8B2FH8",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-VQGL8B2FH8",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  
    <meta http-equiv="refresh" content="0; URL='https://docs.aws.amazon.com/eks/latest/best-practices/application.html'" />
    <link rel="canonical" href="https://docs.aws.amazon.com/eks/latest/best-practices/application.html" />
  
  

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#running-highly-available-applications" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
<h2 style="color:#F2F2F2;text-align: center;"><b> The EKS Best Practices Guide has moved to the <a style="color:#ff9900;text-decoration: underline" href="https://docs.aws.amazon.com/eks/latest/best-practices/introduction.html">AWS Documentation</a></u>. Check there for the latest updates. </b></h2>

          </div>
          
        </aside>
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="EKS Best Practices Guides" class="md-header__button md-logo" aria-label="EKS Best Practices Guides" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EKS Best Practices Guides
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Applications
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../ko/reliability/docs/application/" hreflang="ko" class="md-select__link">
              한국어
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/aws/aws-eks-best-practices" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    aws/aws-eks-best-practices
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="EKS Best Practices Guides" class="md-nav__button md-logo" aria-label="EKS Best Practices Guides" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    EKS Best Practices Guides
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aws/aws-eks-best-practices" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    aws/aws-eks-best-practices
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/docs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/docs/iam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Identity and Access Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/docs/pods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pod Security
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/docs/multitenancy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-tenancy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/docs/detective/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Detective Controls
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/docs/network/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Network Security
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/docs/data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Encryption and Secrets Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/docs/runtime/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runtime Security
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/docs/hosts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Infrastructure Security
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/docs/compliance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Regulatory Compliance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/docs/incidents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Incident Response and Forensics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/docs/image/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Image Security
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/docs/multiaccount/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi Account Strategy
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cluster Autoscaling
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Cluster Autoscaling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../karpenter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Karpenter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cluster-autoscaling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cluster-Autoscaler
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reliability
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reliability
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Applications
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Applications
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#recommendations" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#avoid-running-singleton-pods" class="md-nav__link">
    <span class="md-ellipsis">
      Avoid running singleton Pods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-multiple-replicas" class="md-nav__link">
    <span class="md-ellipsis">
      Run multiple replicas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schedule-replicas-across-nodes" class="md-nav__link">
    <span class="md-ellipsis">
      Schedule replicas across nodes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Schedule replicas across nodes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-pod-anti-affinity-rules" class="md-nav__link">
    <span class="md-ellipsis">
      Using Pod anti-affinity rules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-pod-topology-spread-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Using Pod topology spread constraints
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-kubernetes-metrics-server" class="md-nav__link">
    <span class="md-ellipsis">
      Run Kubernetes Metrics Server
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#horizontal-pod-autoscaler-hpa" class="md-nav__link">
    <span class="md-ellipsis">
      Horizontal Pod Autoscaler (HPA)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Horizontal Pod Autoscaler (HPA)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scaling-applications-based-on-custom-or-external-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Scaling applications based on custom or external metrics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vertical-pod-autoscaler-vpa" class="md-nav__link">
    <span class="md-ellipsis">
      Vertical Pod Autoscaler (VPA)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-applications" class="md-nav__link">
    <span class="md-ellipsis">
      Updating applications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Updating applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#have-a-mechanism-to-perform-rollbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Have a mechanism to perform rollbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-bluegreen-deployments" class="md-nav__link">
    <span class="md-ellipsis">
      Use blue/green deployments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-canary-deployments" class="md-nav__link">
    <span class="md-ellipsis">
      Use Canary deployments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#health-checks-and-self-healing" class="md-nav__link">
    <span class="md-ellipsis">
      Health checks and self-healing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommendations_1" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-liveness-probe-to-remove-unhealthy-pods" class="md-nav__link">
    <span class="md-ellipsis">
      Use Liveness Probe to remove unhealthy pods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-startup-probe-for-applications-that-take-longer-to-start" class="md-nav__link">
    <span class="md-ellipsis">
      Use Startup Probe for applications that take longer to start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-readiness-probe-to-detect-partial-unavailability" class="md-nav__link">
    <span class="md-ellipsis">
      Use Readiness Probe to detect partial unavailability
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dealing-with-disruptions" class="md-nav__link">
    <span class="md-ellipsis">
      Dealing with disruptions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommendations_2" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#protect-critical-workload-with-pod-disruption-budgets" class="md-nav__link">
    <span class="md-ellipsis">
      Protect critical workload with Pod Disruption Budgets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practice-chaos-engineering" class="md-nav__link">
    <span class="md-ellipsis">
      Practice chaos engineering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-a-service-mesh" class="md-nav__link">
    <span class="md-ellipsis">
      Use a Service Mesh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-meshes" class="md-nav__link">
    <span class="md-ellipsis">
      Service Meshes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#observability" class="md-nav__link">
    <span class="md-ellipsis">
      Observability
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommendations_3" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#monitor-your-applications" class="md-nav__link">
    <span class="md-ellipsis">
      Monitor your applications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-prometheus-client-library-to-expose-application-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Use Prometheus client library to expose application metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-centralized-logging-tools-to-collect-and-persist-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Use centralized logging tools to collect and persist logs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-a-distributed-tracing-system-to-identify-bottlenecks" class="md-nav__link">
    <span class="md-ellipsis">
      Use a distributed tracing system to identify bottlenecks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../controlplane/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Control Plane
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataplane/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Plane
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Networking
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Networking
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../networking/index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../networking/subnets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VPC and Subnet Considerations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../networking/vpc-cni/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Amazon VPC CNI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../networking/ip-optimization-strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimizing IP Address Utilization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../networking/ipv6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running IPv6 Clusters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../networking/custom-networking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Networking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../networking/prefix-mode/index_linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prefix Mode for Linux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../networking/prefix-mode/index_windows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prefix Mode for Windows
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../networking/sgpp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security Groups per Pod
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../networking/loadbalancing/loadbalancing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Load Balancing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../networking/monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monitoring for Network performance issues
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../networking/ipvs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running kube-proxy in IPVS Mode
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Scalability
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Scalability
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../scalability/docs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../scalability/docs/control-plane/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Control Plane
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../scalability/docs/data-plane/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Plane
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../scalability/docs/cluster-services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cluster Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../scalability/docs/workloads/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Workloads
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../scalability/docs/scaling_theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The theory behind scaling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../scalability/docs/kcp_monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Control plane monitoring
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../scalability/docs/node_efficiency/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Node efficiency and scaling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../scalability/docs/kubernetes_slos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kubernetes SLOs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../scalability/docs/quotas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Known limits and service quotas
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../upgrades/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cluster Upgrades
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cost Optimization
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Cost Optimization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cost_optimization/cost_optimization_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cost_optimization/cfm_framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloud Financial Management Framework
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cost_optimization/awareness/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Awareness
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cost_optimization/cost_opt_compute/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compute
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cost_optimization/cost_opt_networking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Network
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cost_optimization/cost_opt_storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Storage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cost_optimization/cost_opt_observability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Observability
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Windows Containers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Windows Containers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/docs/ami/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AMI Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/docs/gmsa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    gMSA for Windows Containers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/docs/hardening/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Windows Server Hardening
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/docs/images/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scanning Windows Images
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/docs/licensing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Windows Versions and Licensing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/docs/logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/docs/monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monitoring Windows Containers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/docs/networking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Windows Networking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/docs/oom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Memory and Systems Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/docs/patching/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Infrastructure Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/docs/scheduling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scheduling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/docs/security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pod Security for Windows Containers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../windows/docs/storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Storage Options
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#recommendations" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#avoid-running-singleton-pods" class="md-nav__link">
    <span class="md-ellipsis">
      Avoid running singleton Pods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-multiple-replicas" class="md-nav__link">
    <span class="md-ellipsis">
      Run multiple replicas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schedule-replicas-across-nodes" class="md-nav__link">
    <span class="md-ellipsis">
      Schedule replicas across nodes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Schedule replicas across nodes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-pod-anti-affinity-rules" class="md-nav__link">
    <span class="md-ellipsis">
      Using Pod anti-affinity rules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-pod-topology-spread-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Using Pod topology spread constraints
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-kubernetes-metrics-server" class="md-nav__link">
    <span class="md-ellipsis">
      Run Kubernetes Metrics Server
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#horizontal-pod-autoscaler-hpa" class="md-nav__link">
    <span class="md-ellipsis">
      Horizontal Pod Autoscaler (HPA)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Horizontal Pod Autoscaler (HPA)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scaling-applications-based-on-custom-or-external-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Scaling applications based on custom or external metrics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vertical-pod-autoscaler-vpa" class="md-nav__link">
    <span class="md-ellipsis">
      Vertical Pod Autoscaler (VPA)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-applications" class="md-nav__link">
    <span class="md-ellipsis">
      Updating applications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Updating applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#have-a-mechanism-to-perform-rollbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Have a mechanism to perform rollbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-bluegreen-deployments" class="md-nav__link">
    <span class="md-ellipsis">
      Use blue/green deployments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-canary-deployments" class="md-nav__link">
    <span class="md-ellipsis">
      Use Canary deployments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#health-checks-and-self-healing" class="md-nav__link">
    <span class="md-ellipsis">
      Health checks and self-healing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommendations_1" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-liveness-probe-to-remove-unhealthy-pods" class="md-nav__link">
    <span class="md-ellipsis">
      Use Liveness Probe to remove unhealthy pods
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-startup-probe-for-applications-that-take-longer-to-start" class="md-nav__link">
    <span class="md-ellipsis">
      Use Startup Probe for applications that take longer to start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-readiness-probe-to-detect-partial-unavailability" class="md-nav__link">
    <span class="md-ellipsis">
      Use Readiness Probe to detect partial unavailability
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dealing-with-disruptions" class="md-nav__link">
    <span class="md-ellipsis">
      Dealing with disruptions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommendations_2" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#protect-critical-workload-with-pod-disruption-budgets" class="md-nav__link">
    <span class="md-ellipsis">
      Protect critical workload with Pod Disruption Budgets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#practice-chaos-engineering" class="md-nav__link">
    <span class="md-ellipsis">
      Practice chaos engineering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-a-service-mesh" class="md-nav__link">
    <span class="md-ellipsis">
      Use a Service Mesh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-meshes" class="md-nav__link">
    <span class="md-ellipsis">
      Service Meshes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#observability" class="md-nav__link">
    <span class="md-ellipsis">
      Observability
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommendations_3" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#monitor-your-applications" class="md-nav__link">
    <span class="md-ellipsis">
      Monitor your applications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-prometheus-client-library-to-expose-application-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Use Prometheus client library to expose application metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-centralized-logging-tools-to-collect-and-persist-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Use centralized logging tools to collect and persist logs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-a-distributed-tracing-system-to-identify-bottlenecks" class="md-nav__link">
    <span class="md-ellipsis">
      Use a distributed tracing system to identify bottlenecks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<div class="admonition info">
<p class="admonition-title">We've Moved to the AWS Docs! 🚀</p>
<p>This content has been updated and relocated to improve your experience. 
Please visit our new site for the latest version:
<a href="https://docs.aws.amazon.com/eks/latest/best-practices/application.html">AWS EKS Best Practices Guide</a> on the AWS Docs</p>
<p>Bookmarks and links will continue to work, but we recommend updating them for faster access in the future.</p>
</div>
<hr />
<h1 id="running-highly-available-applications">Running highly-available applications<a class="headerlink" href="#running-highly-available-applications" title="Permanent link">&para;</a></h1>
<p>Your customers expect your application to be always available, including when you're making changes and especially during spikes in traffic. A scalable and resilient architecture keeps your applications and services running without disruptions, which keeps your users happy. A scalable infrastructure grows and shrinks based on the needs of the business. Eliminating single points of failure is a critical step towards improving an application's availability and making it resilient.</p>
<p>With Kubernetes, you can operate your applications and run them in a highly-available and resilient fashion. Its declarative management ensures that once you've set up the application, Kubernetes will continuously try to <a href="https://kubernetes.io/docs/concepts/architecture/controller/#desired-vs-current">match the current state with the desired state</a>.</p>
<h2 id="recommendations">Recommendations<a class="headerlink" href="#recommendations" title="Permanent link">&para;</a></h2>
<h3 id="avoid-running-singleton-pods">Avoid running singleton Pods<a class="headerlink" href="#avoid-running-singleton-pods" title="Permanent link">&para;</a></h3>
<p>If your entire application runs in a single Pod, then your application will be unavailable if that Pod gets terminated. Instead of deploying applications using individual pods, create <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">Deployments</a>. If a Pod that is created by a Deployment fails or gets terminated, the Deployment <a href="https://kubernetes.io/docs/concepts/architecture/controller/">controller</a> will start a new pod to ensure the specified number of replica Pods are always running. </p>
<h3 id="run-multiple-replicas">Run multiple replicas<a class="headerlink" href="#run-multiple-replicas" title="Permanent link">&para;</a></h3>
<p>Running multiple replicas Pods of an app using a Deployment helps it run in a highly-available manner. If one replica fails, the remaining replicas will still function, albeit at reduced capacity until Kubernetes creates another Pod to make up for the loss. Furthermore, you can use the <a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/">Horizontal Pod Autoscaler</a> to scale replicas automatically based on workload demand. </p>
<h3 id="schedule-replicas-across-nodes">Schedule replicas across nodes<a class="headerlink" href="#schedule-replicas-across-nodes" title="Permanent link">&para;</a></h3>
<p>Running multiple replicas won't be very useful if all the replicas are running on the same node, and the node becomes unavailable. Consider using pod anti-affinity or pod topology spread constraints to spread replicas of a Deployment across multiple worker nodes. </p>
<p>You can further improve a typical application's reliability by running it across multiple AZs. </p>
<h4 id="using-pod-anti-affinity-rules">Using Pod anti-affinity rules<a class="headerlink" href="#using-pod-anti-affinity-rules" title="Permanent link">&para;</a></h4>
<p>The manifest below tells Kubernetes scheduler to <em>prefer</em> to place pods on separate nodes and AZs. It doesn't require distinct nodes or AZ because if it did, then Kubernetes will not be able to schedule any pods once there is a pod running in each AZ. If your application requires just three replicas, you can use <code>requiredDuringSchedulingIgnoredDuringExecution</code> for <code>topologyKey: topology.kubernetes.io/zone</code>, and Kubernetes scheduler will not schedule two pods in the same AZ.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>apiVersion: apps/v1
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>kind: Deployment
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>metadata:
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>  name: spread-host-az
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>  labels:
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    app: web-server
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>spec:
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>  replicas: 4
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>  selector:
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    matchLabels:
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>      app: web-server
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>  template:
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    metadata:
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>      labels:
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>        app: web-server
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    spec:
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>      affinity:
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>        podAntiAffinity:
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>          preferredDuringSchedulingIgnoredDuringExecution:
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>          - podAffinityTerm:
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>              labelSelector:
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>                matchExpressions:
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>                - key: app
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>                  operator: In
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>                  values:
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>                  - web-server
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>              topologyKey: topology.kubernetes.io/zone
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>            weight: 100
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>          - podAffinityTerm:
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>              labelSelector:
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>                matchExpressions:
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>                - key: app
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>                  operator: In
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>                  values:
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>                  - web-server
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>              topologyKey: kubernetes.io/hostname 
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>            weight: 99
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>      containers:
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>      - name: web-app
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>        image: nginx:1.16-alpine
</code></pre></div>
<h4 id="using-pod-topology-spread-constraints">Using Pod topology spread constraints<a class="headerlink" href="#using-pod-topology-spread-constraints" title="Permanent link">&para;</a></h4>
<p>Similar to pod anti-affinity rules, pod topology spread constraints allow you to make your application available across different failure (or topology) domains like hosts or AZs. This approach works very well when you're trying to ensure fault tolerance as well as availability by having multiple replicas in each of the different topology domains. Pod anti-affinity rules, on the other hand, can easily produce a result where you have a single replica in a topology domain because the pods with an anti-affinity toward each other have a repelling effect. In such cases, a single replica on a dedicated node isn't ideal for fault tolerance nor is it a good use of resources. With topology spread constraints, you have more control over the spread or distribution that the scheduler should try to apply across the topology domains. Here are some important properties to use in this approach:
1. The <code>maxSkew</code> is used to control or determine the maximum point to which things can be uneven across the topology domains. For example, if an application has 10 replicas and is deployed across 3 AZs, you can't get an even spread, but you can influence how uneven the distribution will be. In this case, the <code>maxSkew</code> can be anything between 1 and 10. A value of 1 means you can potentially end up with a spread like <code>4,3,3</code>, <code>3,4,3</code> or <code>3,3,4</code> across the 3 AZs. In contrast, a value of 10 means you can potentially end up with a spread like <code>10,0,0</code>, <code>0,10,0</code> or <code>0,0,10</code> across 3 AZs.
2. The <code>topologyKey</code> is a key for one of the node labels and defines the type of topology domain that should be used for the pod distribution. For example, a zonal spread would have the following key-value pair:
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>topologyKey: &quot;topology.kubernetes.io/zone&quot;
</code></pre></div>
3. The <code>whenUnsatisfiable</code> property is used to determine how you want the scheduler to respond if the desired constraints can't be satisfied.
4. The <code>labelSelector</code> is used to find matching pods so that the scheduler can be aware of them when deciding where to place pods in accordance with the constraints that you specify.</p>
<p>In addition to these above, there are other fields that you can read about further in the <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/topology-spread-constraints/">Kubernetes documentation</a>.</p>
<p><img alt="Pod topology spread constraints across 3 AZs" src="../images/pod-topology-spread-constraints.jpg" /></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>apiVersion: apps/v1
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>kind: Deployment
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>metadata:
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>  name: spread-host-az
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>  labels:
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>    app: web-server
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>spec:
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>  replicas: 10
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>  selector:
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>    matchLabels:
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>      app: web-server
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>  template:
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>    metadata:
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>      labels:
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>        app: web-server
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>    spec:
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>      topologySpreadConstraints:
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>      - maxSkew: 1
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>        topologyKey: &quot;topology.kubernetes.io/zone&quot;
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>        whenUnsatisfiable: ScheduleAnyway
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>        labelSelector:
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>          matchLabels:
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>            app: express-test
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>      containers:
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>      - name: web-app
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>        image: nginx:1.16-alpine
</code></pre></div>
<h3 id="run-kubernetes-metrics-server">Run Kubernetes Metrics Server<a class="headerlink" href="#run-kubernetes-metrics-server" title="Permanent link">&para;</a></h3>
<p>Install the Kubernetes <a href="https://github.com/kubernetes-sigs/metrics-server">metrics server</a> to help scale your applications. Kubernetes autoscaler add-ons like <a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/">HPA</a> and <a href="https://github.com/kubernetes/autoscaler/tree/master/vertical-pod-autoscaler">VPA</a> need to track metrics of applications to scale them. The metrics-server collects resource metrics that can be used to make scaling decisions. The metrics are collected from kubelets and served in <a href="https://github.com/kubernetes/metrics">Metrics API format</a>.</p>
<p>The metrics server doesn't retain any data, and it's not a monitoring solution. Its purpose is to expose CPU and memory usage metrics to other systems. If you want to track your application's state over time, you need a monitoring tool like Prometheus or Amazon CloudWatch. </p>
<p>Follow the <a href="https://docs.aws.amazon.com/eks/latest/userguide/metrics-server.html">EKS documentation</a> to install metrics-server in your EKS cluster. </p>
<h2 id="horizontal-pod-autoscaler-hpa">Horizontal Pod Autoscaler (HPA)<a class="headerlink" href="#horizontal-pod-autoscaler-hpa" title="Permanent link">&para;</a></h2>
<p>HPA can automatically scale your application in response to demand and help you avoid impacting your customers during peak traffic. It is implemented as a control loop in Kubernetes that periodically queries metrics from APIs that provide resource metrics.</p>
<p>HPA can retrieve metrics from the following APIs:
1. <code>metrics.k8s.io</code> also known as Resource Metrics API — Provides CPU and memory usage for pods
2. <code>custom.metrics.k8s.io</code> — Provides metrics from other metric collectors like Prometheus; these metrics are <strong>internal</strong> to your Kubernetes cluster. 
3. <code>external.metrics.k8s.io</code> — Provides metrics that are <strong>external</strong> to your Kubernetes cluster (E.g., SQS Queue Depth, ELB latency).</p>
<p>You must use one of these three APIs to provide the metric to scale your application. </p>
<h3 id="scaling-applications-based-on-custom-or-external-metrics">Scaling applications based on custom or external metrics<a class="headerlink" href="#scaling-applications-based-on-custom-or-external-metrics" title="Permanent link">&para;</a></h3>
<p>You can use custom or external metrics to scale your application on metrics other than CPU or memory utilization. <a href="https://github.com/kubernetes-sigs/custom-metrics-apiserver">Custom Metrics</a> API servers provide the <code>custom-metrics.k8s.io</code> API that HPA can use to autoscale applications. </p>
<p>You can use the <a href="https://github.com/directxman12/k8s-prometheus-adapter">Prometheus Adapter for Kubernetes Metrics APIs</a> to collect metrics from Prometheus and use with the HPA. In this case, Prometheus adapter will expose Prometheus metrics in <a href="https://github.com/kubernetes/metrics/blob/master/pkg/apis/metrics/types.go">Metrics API format</a>. </p>
<p>Once you deploy the Prometheus Adapter, you can query custom metrics using kubectl.
<code>kubectl get —raw /apis/custom.metrics.k8s.io/v1beta1/</code></p>
<p>External metrics, as the name suggests, provide the Horizontal Pod Autoscaler the ability to scale deployments using metrics that are external to the Kubernetes cluster. For example, in batch processing workloads, it is common to scale the number of replicas based on the number of jobs in flight in an SQS queue.</p>
<p>To autoscale Kubernetes workloads you can use KEDA (Kubernetes Event-driven Autoscaling), an open-source project that can drive container scaling based on a number of custom events. This <a href="https://aws.amazon.com/blogs/mt/autoscaling-kubernetes-workloads-with-keda-using-amazon-managed-service-for-prometheus-metrics/">AWS blog</a> outlines how to use Amazon Managed Service for Prometheus for Kubernetes workload auto-scaling.</p>
<h2 id="vertical-pod-autoscaler-vpa">Vertical Pod Autoscaler (VPA)<a class="headerlink" href="#vertical-pod-autoscaler-vpa" title="Permanent link">&para;</a></h2>
<p>VPA automatically adjusts the CPU and memory reservation for your Pods to help you “right-size” your applications. For applications that need to be scaled vertically - which is done by increasing resource allocation - you can use <a href="https://github.com/kubernetes/autoscaler/tree/master/vertical-pod-autoscaler">VPA</a> to automatically scale Pod replicas or provide scaling recommendations.</p>
<p>Your application may become temporarily unavailable if VPA needs to scale it because VPA's current implementation does not perform in-place adjustments to Pods; instead, it will recreate the Pod that needs to be scaled. </p>
<p><a href="https://docs.aws.amazon.com/eks/latest/userguide/vertical-pod-autoscaler.html">EKS Documentation</a> includes a walkthrough for setting up VPA. </p>
<p><a href="https://github.com/FairwindsOps/goldilocks/">Fairwinds Goldilocks</a> project provides a dashboard to visualize VPA recommendations for CPU and memory requests and limits. Its VPA update mode allows you to auto-scale Pods based on VPA recommendations. </p>
<h2 id="updating-applications">Updating applications<a class="headerlink" href="#updating-applications" title="Permanent link">&para;</a></h2>
<p>Modern applications require rapid innovation with a high degree of stability and availability. Kubernetes gives you the tools to update your applications continuously without disrupting your customers. </p>
<p>Let's look at some of the best practices that make it possible to quickly deploy changes without sacrificing availability.</p>
<h3 id="have-a-mechanism-to-perform-rollbacks">Have a mechanism to perform rollbacks<a class="headerlink" href="#have-a-mechanism-to-perform-rollbacks" title="Permanent link">&para;</a></h3>
<p>Having an undo button can evade disasters. It is a best practice to test deployments in a separate lower environment (test or development environment) before updating the production cluster. Using a CI/CD pipeline can help you automate and test deployments. With a continuous deployment pipeline, you can quickly revert to the older version if the upgrade happens to be defective.  </p>
<p>You can use Deployments to update a running application. This is typically done by updating the container image. You can use <code>kubectl</code> to update a Deployment like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>kubectl<span class="w"> </span>--record<span class="w"> </span>deployment.apps/nginx-deployment<span class="w"> </span><span class="nb">set</span><span class="w"> </span>image<span class="w"> </span>nginx-deployment<span class="w"> </span><span class="nv">nginx</span><span class="o">=</span>nginx:1.16.1
</code></pre></div>
<p>The <code>--record</code> argument record the changes to the Deployment and helps you if you need to perform a rollback. <code>kubectl rollout history deployment</code> shows you the recorded changes to Deployments in your cluster. You can rollback a change using <code>kubectl rollout undo deployment &lt;DEPLOYMENT_NAME&gt;</code>.</p>
<p>By default, when you update a Deployment that requires a recreation of pods, Deployment will perform a <a href="https://kubernetes.io/docs/tutorials/kubernetes-basics/update/update-intro/">rolling update</a>. In other words, Kubernetes will only update a portion of the running pods in a Deployment and not all the Pods at once. You can control how Kubernetes performs rolling updates through <code>RollingUpdateStrategy</code> property. </p>
<p>When performing a <em>rolling update</em> of a Deployment, you can use the <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#max-unavailable"><code>Max Unavailable</code></a> property to specify the maximum number of Pods that can be unavailable during the update. The <code>Max Surge</code> property of Deployment allows you to set the maximum number of Pods that can be created over the desired number of Pods.</p>
<p>Consider adjusting <code>max unavailable</code> to ensure that a rollout doesn't disrupt your customers. For example, Kubernetes sets 25% <code>max unavailable</code> by default, which means if you have 100 Pods, you may have only 75 Pods actively working during a rollout. If your application needs a minimum of 80 Pods, this rollout can be disruptive. Instead, you can set <code>max unavailable</code> to 20% to ensure that there are at least 80 functional Pods throughout the rollout. </p>
<h3 id="use-bluegreen-deployments">Use blue/green deployments<a class="headerlink" href="#use-bluegreen-deployments" title="Permanent link">&para;</a></h3>
<p>Changes are inherently risky, but changes that cannot be undone can be potentially catastrophic. Change procedures that allow you to effectively turn back time through a <em>rollback</em> make enhancements and experimentation safer. Blue/green deployments give you a method to quickly retract the changes if things go wrong. In this deployment strategy, you create an environment for the new version. This environment is identical to the current version of the application being updated. Once the new environment is provisioned, traffic is routed to the new environment. If the new version produces the desired results without generating errors, the old environment is terminated. Otherwise, traffic is restored to the old version. </p>
<p>You can perform blue/green deployments in Kubernetes by creating a new Deployment that is identical to the existing version's Deployment. Once you verify that the Pods in the new Deployment are running without errors, you can start sending traffic to the new Deployment by changing the <code>selector</code> spec in the Service that routes traffic to your application's Pods.</p>
<p>Many continuous integration tools such as <a href="https://fluxcd.io">Flux</a>, <a href="https://www.jenkins.io">Jenkins</a>, and <a href="https://spinnaker.io">Spinnaker</a> let you automate blue/green deployments. AWS Containers Blog includes a walkthrough using AWS Load Balancer Controller: <a href="https://aws.amazon.com/blogs/containers/using-aws-load-balancer-controller-for-blue-green-deployment-canary-deployment-and-a-b-testing/">Using AWS Load Balancer Controller for blue/green deployment, canary deployment and A/B testing</a></p>
<h3 id="use-canary-deployments">Use Canary deployments<a class="headerlink" href="#use-canary-deployments" title="Permanent link">&para;</a></h3>
<p>Canary deployments are a variant of blue/green deployments that can significantly remove risk from changes. In this deployment strategy, you create a new Deployment with fewer Pods alongside your old Deployment, and divert a small percentage of traffic to the new Deployment. If metrics indicate that the new version is performing as well or better than the existing version, you progressively increase traffic to the new Deployment while scaling it up until all traffic is diverted to the new Deployment. If there's an issue, you can route all traffic to the old Deployment and stop sending traffic to the new Deployment.</p>
<p>Although Kubernetes offers no native way to perform canary deployments, you can use tools such as <a href="https://github.com/weaveworks/flagger">Flagger</a> with <a href="https://docs.flagger.app/tutorials/istio-progressive-delivery">Istio</a> or <a href="https://docs.flagger.app/install/flagger-install-on-eks-appmesh">App Mesh</a>.</p>
<h2 id="health-checks-and-self-healing">Health checks and self-healing<a class="headerlink" href="#health-checks-and-self-healing" title="Permanent link">&para;</a></h2>
<p>No software is bug-free, but Kubernetes can help you to minimize the impact of software failures. In the past, if an application crashed, someone had to remediate the situation by restarting the application manually. Kubernetes gives you the ability to detect software failures in your Pods and automatically replace them with new replicas. With Kubernetes you can monitor the health of your applications and automatically replace unhealthy instances.  </p>
<p>Kubernetes supports three types of <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/">health-checks</a>:</p>
<ol>
<li>Liveness probe</li>
<li>Startup probe (supported in Kubernetes version 1.16+)</li>
<li>Readiness probe</li>
</ol>
<p><a href="https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/">Kubelet</a>, the Kubernetes agent, is responsible for running all the above-mentioned checks. Kubelet can check a Pods' health in three ways: kubelet can either run a shell command inside a Pod's container, send an HTTP GET request to its container, or open a TCP socket on a specified port.  </p>
<p>If you choose an <code>exec</code>-based probe, which runs a shell script inside a container, ensure that the shell command exits <em>before</em> the <code>timeoutSeconds</code> value expires. Otherwise, your node will have <code>&lt;defunct&gt;</code> processes, leading to node failure. </p>
<h2 id="recommendations_1">Recommendations<a class="headerlink" href="#recommendations_1" title="Permanent link">&para;</a></h2>
<h3 id="use-liveness-probe-to-remove-unhealthy-pods">Use Liveness Probe to remove unhealthy pods<a class="headerlink" href="#use-liveness-probe-to-remove-unhealthy-pods" title="Permanent link">&para;</a></h3>
<p>The Liveness probe can detect <em>deadlock</em> conditions where the process continues to run, but the application becomes unresponsive. For example, if you are running a web service that listens on port 80, you can configure a Liveness probe to send an HTTP GET request on Pod's port 80. Kubelet will periodically send a GET request to the Pod and expect a response; if the Pod responds between 200-399 then the kubelet considers that Pod is healthy; otherwise, the Pod will be marked as unhealthy. If a Pod fails health-checks continuously, the kubelet will terminate it. </p>
<p>You can use <code>initialDelaySeconds</code> to delay the first probe.</p>
<p>When using the Liveness Probe, ensure that your application doesn't run into a situation in which all Pods simultaneously fail the Liveness Probe because Kubernetes will try to replace all your Pods, which will render your application offline. Furthermore, Kubernetes will continue to create new Pods that will also fail Liveness Probes, putting unnecessary strain on the control plane. Avoid configuring the Liveness Probe to depend on an a factor that is external to your Pod, for example, a external database. In other words, a non-responsive external-to-your-Pod database shouldn't make your Pods fail their Liveness Probes.</p>
<p>Sandor Szücs's post <a href="https://srcco.de/posts/kubernetes-liveness-probes-are-dangerous.html">LIVENESS PROBES ARE DANGEROUS</a> describes problems that can be caused by misconfigured probes.</p>
<h3 id="use-startup-probe-for-applications-that-take-longer-to-start">Use Startup Probe for applications that take longer to start<a class="headerlink" href="#use-startup-probe-for-applications-that-take-longer-to-start" title="Permanent link">&para;</a></h3>
<p>When your app needs additional time to startup, you can use the Startup Probe to delay the Liveness and Readiness Probe. For example, a Java app that needs to hydrate cache from a database may need up to two minutes before it is fully functional. Any Liveness or Readiness Probe until it becomes fully functional might fail. Configuring a Startup Probe will allow the Java app to become <em>healthy</em> before Liveness or Readiness Probe are executed. </p>
<p>Until the Startup Probe succeeds, all the other Probes are disabled. You can define the maximum time Kubernetes should wait for application startup. If, after the maximum configured time, the Pod still fails Startup Probes, it will be terminated, and a new Pod will be created. </p>
<p>The Startup Probe is similar to the Liveness Probe -- if they fail, the Pod is recreated. As Ricardo A. explains in his post <a href="https://medium.com/swlh/fantastic-probes-and-how-to-configure-them-fef7e030bd2f">Fantastic Probes And How To Configure Them</a>, Startup Probes should be used when the startup time of an application is unpredictable. If you know your application needs ten seconds to start, you should use Liveness/Readiness Probe with <code>initialDelaySeconds</code> instead.</p>
<h3 id="use-readiness-probe-to-detect-partial-unavailability">Use Readiness Probe to detect partial unavailability<a class="headerlink" href="#use-readiness-probe-to-detect-partial-unavailability" title="Permanent link">&para;</a></h3>
<p>While the Liveness probe detects failures in an app that are resolved by terminating the Pod (hence, restarting the app), Readiness Probe detects conditions where the app may be <em>temporarily</em> unavailable. In these situations, the app may become temporarily unresponsive; however, it is expected to be healthy again once this operation completes.  </p>
<p>For example, during intense disk I/O operations, applications may be temporarily unavailable to handle requests. Here, terminating the application's Pod is not a remedy; at the same time, additional requests sent to the Pod can fail. </p>
<p>You can use the Readiness Probe to detect temporary unavailability in your app and stop sending requests to its Pod until it becomes functional again. <em>Unlike Liveness Probe, where a failure would result in a recreation of Pod, a failed Readiness Probe would mean that Pod will not receive any traffic from Kubernetes Service</em>. When the Readiness Probe succeeds, Pod will resume receiving traffic from Service. </p>
<p>Just like the Liveness Probe, avoid configuring Readiness Probes that depend on a resource that's external to the Pod (such as a database). Here's a scenario where a poorly configured Readiness can render the application nonfunctional - if a Pod's Readiness Probe fails when the app's database is unreachable, other Pod replicas will also fail simultaneously since they share the same health-check criteria. Setting the probe in this way will ensure that whenever the database is unavailable, the Pod's Readiness Probes will fail, and Kubernetes will stop sending traffic <em>all</em> Pods.  </p>
<p>A side-effect of using Readiness Probes is that they can increase the time it takes to update Deployments. New replicas will not receive traffic unless Readiness Probes are successful; until then, old replicas will continue to receive traffic. </p>
<hr />
<h2 id="dealing-with-disruptions">Dealing with disruptions<a class="headerlink" href="#dealing-with-disruptions" title="Permanent link">&para;</a></h2>
<p>Pods have a finite lifetime - even if you have long-running Pods, it's prudent to ensure Pods terminate correctly when the time comes. Depending on your upgrade strategy, Kubernetes cluster upgrades may require you to create new worker nodes, which requires all Pods to be recreated on newer nodes. Proper termination handling and Pod Disruption Budgets can help you avoid service disruptions as Pods are removed from older nodes and recreated on newer nodes.  </p>
<p>The preferred way to upgrade worker nodes is by creating new worker nodes and terminating old ones. Before terminating worker nodes, you should <code>drain</code> it. When a worker node is drained, all its pods are <em>safely</em> evicted. Safely is a key word here; when pods on a worker are evicted, they are not simply sent a <code>SIGKILL</code> signal. Instead, a <code>SIGTERM</code> signal is sent to the main process (PID 1) of each container in the Pods being evicted. After the <code>SIGTERM</code> signal is sent, Kubernetes will give the process some time (grace period) before a <code>SIGKILL</code> signal is sent. This grace period is 30 seconds by default; you can override the default by using <code>grace-period</code> flag in kubectl or declare <code>terminationGracePeriodSeconds</code> in your Podspec.</p>
<p><code>kubectl delete pod &lt;pod name&gt; —grace-period=&lt;seconds&gt;</code></p>
<p>It is common to have containers in which the main process doesn't have PID 1. Consider this Python-based sample container:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>$ kubectl exec python-app -it ps
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a> PID USER TIME COMMAND
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a> 1   root 0:00 {script.sh} /bin/sh ./script.sh
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a> 5   root 0:00 python app.py
</code></pre></div>
<p>In this example, the shell script receives <code>SIGTERM</code>, the main process, which happens to be a Python application in this example, doesn't get a <code>SIGTERM</code> signal. When the Pod is terminated, the Python application will be killed abruptly. This can be remediated by changing the <a href="https://docs.docker.com/engine/reference/builder/#entrypoint"><code>ENTRYPOINT</code></a> of the container to launch the Python application. Alternatively, you can use a tool like <a href="https://github.com/Yelp/dumb-init">dumb-init</a> to ensure that your application can handle signals.  </p>
<p>You can also use <a href="https://kubernetes.io/docs/concepts/containers/container-lifecycle-hooks/#container-hooks">Container hooks</a> to execute a script or an HTTP request at container start or stop. The <code>PreStop</code> hook action runs before the container receives a <code>SIGTERM</code> signal and must complete before this signal is sent. The <code>terminationGracePeriodSeconds</code> value applies from when the <code>PreStop</code> hook action begins executing, not when the <code>SIGTERM</code> signal is sent.</p>
<h2 id="recommendations_2">Recommendations<a class="headerlink" href="#recommendations_2" title="Permanent link">&para;</a></h2>
<h3 id="protect-critical-workload-with-pod-disruption-budgets">Protect critical workload with Pod Disruption Budgets<a class="headerlink" href="#protect-critical-workload-with-pod-disruption-budgets" title="Permanent link">&para;</a></h3>
<p>Pod Disruption Budget or PDB can temporarily halt the eviction process if the number of replicas of an application falls below the declared threshold. The eviction process will continue once the number of available replicas is over the threshold. You can use PDB to declare the <code>minAvailable</code> and <code>maxUnavailable</code> number of replicas. For example, if you want at least three copies of your app to be available, you can create a PDB. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>apiVersion: policy/v1beta1
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>kind: PodDisruptionBudget
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>metadata:
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>  name: my-svc-pdb
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>spec:
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>  minAvailable: 3
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>  selector:
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>    matchLabels:
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>      app: my-svc
</code></pre></div>
<p>The above PDB policy tells Kubernetes to halt the eviction process until three or more replicas are available. Node draining respects <code>PodDisruptionBudgets</code>. During an EKS managed node group upgrade, <a href="https://docs.aws.amazon.com/eks/latest/userguide/managed-node-update-behavior.html">nodes are drained with a fifteen-minute timeout</a>. After fifteen minutes, if the update is not forced (the option is called Rolling update in the EKS console), the update fails. If the update is forced, the pods are deleted.</p>
<p>For self-managed nodes, you can also use tools like <a href="https://github.com/aws/aws-node-termination-handler">AWS Node Termination Handler</a>, which ensures that the Kubernetes control plane responds appropriately to events that can cause your EC2 instance to become unavailable, such as <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/monitoring-instances-status-check_sched.html">EC2 maintenance</a> events and <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/spot-interruptions.html">EC2 Spot interruptions</a>. It uses the Kubernetes API to cordon the node to ensure no new Pods are scheduled, then drains it, terminating any running Pods.</p>
<p>You can use Pod anti-affinity to schedule a Deployment‘s Pods on different nodes and avoid PDB related delays during node upgrades. </p>
<h3 id="practice-chaos-engineering">Practice chaos engineering<a class="headerlink" href="#practice-chaos-engineering" title="Permanent link">&para;</a></h3>
<blockquote>
<p>Chaos Engineering is the discipline of experimenting on a distributed system in order to build confidence in the system's capability to withstand turbulent conditions in production.</p>
</blockquote>
<p>In his blog, Dominik Tornow explains that <a href="https://medium.com/@dominik.tornow/the-mechanics-of-kubernetes-ac8112eaa302">Kubernetes is a declarative system</a> where “<em>the user supplies a representation of the desired state of the system to the system. The system then considers the current state and the desired state to determine the sequence of commands to transition from the current state to the desired state.</em>” This means Kubernetes always stores the <em>desired state</em> and if the system deviates, Kubernetes will take action to restore the state. For example, if a worker node becomes unavailable, Kubernetes will reschedule the Pods onto another worker node. Similarly, if a <code>replica</code> crashes, the <a href="https://kubernetes.io/docs/concepts/architecture/controller/#design">Deployment Contoller</a> will create a new <code>replica</code>. In this way, Kubernetes controllers automatically fix failures. </p>
<p>Chaos engineering tools like <a href="https://www.gremlin.com">Gremlin</a> help you test the resiliency of your Kubernetes cluster and identify single points of failure. Tools that introduce artificial chaos in your cluster (and beyond) can uncover systemic weaknesses, present an opportunity to identify  bottlenecks and misconfigurations, and rectify problems in a controlled environment. The Chaos Engineering philosophy advocates breaking things on purpose and stress testing infrastructure to minimize unanticipated downtime. </p>
<h3 id="use-a-service-mesh">Use a Service Mesh<a class="headerlink" href="#use-a-service-mesh" title="Permanent link">&para;</a></h3>
<p>You can use a service mesh to improve your application's resiliency. Service meshes enable service-to-service communication and increase the observability of your microservices network. Most service mesh products work by having a small network proxy run alongside each service that intercepts and inspects the application's network traffic. You can place your application in a mesh without modifying your application. Using service proxy's built-in features, you can have it generate network statistics, create access logs, and add HTTP headers to outbound requests for distributed tracing.</p>
<p>A service mesh can help you make your microservices more resilient with features like automatic request retries, timeouts, circuit-breaking, and rate-limiting.</p>
<p>If you operate multiple clusters, you can use a service mesh to enable cross-cluster service-to-service communication.</p>
<h3 id="service-meshes">Service Meshes<a class="headerlink" href="#service-meshes" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://aws.amazon.com/app-mesh/">AWS App Mesh</a></li>
<li><a href="https://istio.io">Istio</a></li>
<li><a href="http://linkerd.io">LinkerD</a></li>
<li><a href="https://www.consul.io">Consul</a></li>
</ul>
<hr />
<h2 id="observability">Observability<a class="headerlink" href="#observability" title="Permanent link">&para;</a></h2>
<p>Observability is an umbrella term that includes monitoring, logging, and tracing. Microservices based applications are distributed by nature. Unlike monolithic applications where monitoring a single system is sufficient, in a distributed application architecture, you need to monitor each component's performance. You can use cluster-level monitoring, logging, and distributed tracing systems to identify issues in your cluster before they disrupt your customers. </p>
<p>Kubernetes built-in tools for troubleshooting and monitoring are limited. The metrics-server collects resource metrics and stores them in memory but doesn't persist them. You can view the logs of a Pod using kubectl, but Kubernetes doesn't automatically retain logs. And the implementation of distributed tracing is done either at the application code level or using services meshes. </p>
<p>Kubernetes' extensibility shines here. Kubernetes allows you to bring your preferred centralized monitoring, logging, and tracing solution. </p>
<h2 id="recommendations_3">Recommendations<a class="headerlink" href="#recommendations_3" title="Permanent link">&para;</a></h2>
<h3 id="monitor-your-applications">Monitor your applications<a class="headerlink" href="#monitor-your-applications" title="Permanent link">&para;</a></h3>
<p>The number of metrics you need to monitor in modern applications is growing continuously. It helps if you have an automated way to track your applications so you can focus on solving your customer's challenges. Cluster-wide monitoring tools like <a href="https://prometheus.io">Prometheus</a> or <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/ContainerInsights.html">CloudWatch Container Insights</a> can monitor your cluster and workload and provide you signals when, or preferably, before things go wrong. </p>
<p>Monitoring tools allow you to create alerts that your operations team can subscribe to. Consider rules to activate alarms for events that can, when exacerbated, lead to an outage or impact application performance. </p>
<p>If you're unclear on which metrics you should monitor, you can take inspiration from these methods:</p>
<ul>
<li><a href="https://www.weave.works/blog/a-practical-guide-from-instrumenting-code-to-specifying-alerts-with-the-red-method">RED method</a>. Stands for requests, errors, and duration. </li>
<li><a href="http://www.brendangregg.com/usemethod.html">USE method</a>. Stands for utilization, saturation, and errors.  </li>
</ul>
<p>Sysdig's post <a href="https://sysdig.com/blog/alerting-kubernetes/">Best practices for alerting on Kubernetes</a> includes a comprehensive list of components that can impact the availability of your applications.</p>
<h3 id="use-prometheus-client-library-to-expose-application-metrics">Use Prometheus client library to expose application metrics<a class="headerlink" href="#use-prometheus-client-library-to-expose-application-metrics" title="Permanent link">&para;</a></h3>
<p>In addition to monitoring the state of the application and aggregating standard metrics, you can also use the <a href="https://prometheus.io/docs/instrumenting/clientlibs/">Prometheus client library</a> to expose application-specific custom metrics to improve the application's observability.</p>
<h3 id="use-centralized-logging-tools-to-collect-and-persist-logs">Use centralized logging tools to collect and persist logs<a class="headerlink" href="#use-centralized-logging-tools-to-collect-and-persist-logs" title="Permanent link">&para;</a></h3>
<p>Logging in EKS falls under two categories: control plane logs and application logs. EKS control plane logging provides audit and diagnostic logs directly from the control plane to CloudWatch Logs in your account. Application logs are logs produced by Pods running inside your cluster. Application logs include logs produced by Pods that run the business logic applications and Kubernetes system components such as CoreDNS, Cluster Autoscaler, Prometheus, etc. </p>
<p><a href="https://docs.aws.amazon.com/eks/latest/userguide/control-plane-logs.html">EKS provide five types of control plane logs</a>:</p>
<ol>
<li>Kubernetes API server component logs</li>
<li>Audit</li>
<li>Authenticator</li>
<li>Controller manager </li>
<li>Scheduler</li>
</ol>
<p>The controller manager and scheduler logs can help diagnose control plane problems such as bottlenecks and errors. By default, EKS control plane logs aren't sent to CloudWatch Logs. You can enable control plane logging and select the types of EKS control plane logs you'd like to capture for each cluster in your account</p>
<p>Collecting application logs requires installing a log aggregator tool like <a href="http://fluentbit.io">Fluent Bit</a>, <a href="https://www.fluentd.org">Fluentd</a>, or <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/deploy-container-insights-EKS.html">CloudWatch Container Insights</a> in your cluster.  </p>
<p>Kubernetes log aggregator tools run as DaemonSets and scrape container logs from nodes. Application logs are then sent to a centralized destination for storage. For example, CloudWatch Container Insights can use either Fluent Bit or Fluentd to collect logs and ship them to CloudWatch Logs for storage. Fluent Bit and Fluentd support many popular log analytics systems such as Elasticsearch and InfluxDB giving you the ability to change the storage backend for your logs by modifying Fluent bit or Fluentd's log configuration. </p>
<h3 id="use-a-distributed-tracing-system-to-identify-bottlenecks">Use a distributed tracing system to identify bottlenecks<a class="headerlink" href="#use-a-distributed-tracing-system-to-identify-bottlenecks" title="Permanent link">&para;</a></h3>
<p>A typical modern application has components distributed over the network, and its reliability depends on the proper functioning of each of the components that make up the application. You can use a distributed tracing solution to understand how requests flow and how systems communicate. Traces can show you where bottlenecks exist in your application network and prevent problems that can cause cascading failures. </p>
<p>You have two options to implement tracing in your applications: you can either implement distributed tracing at the code level using shared libraries or use a service mesh. </p>
<p>Implementing tracing at the code level can be disadvantageous. In this method, you have to make changes to your code. This is further complicated if you have polyglot applications. You're also responsible for maintaining yet another library, across your services. </p>
<p>Service Meshes like <a href="http://linkerd.io">LinkerD</a>, <a href="http://istio.io">Istio</a>, and <a href="https://aws.amazon.com/app-mesh/">AWS App Mesh</a> can be used to implement distributed tracing in your application with minimal changes to the application code. You can use service mesh to standardize metrics generation, logging, and tracing. </p>
<p>Tracing tools like <a href="https://aws.amazon.com/xray/">AWS X-Ray</a>, <a href="https://www.jaegertracing.io">Jaeger</a> support both shared library and service mesh implementations. </p>
<p>Consider using a tracing tool like <a href="https://aws.amazon.com/xray/">AWS X-Ray</a> or <a href="https://www.jaegertracing.io">Jaeger</a> that supports both (shared library and service mesh) implementations so you will not have to switch tools if you later adopt service mesh. </p>







  
  



  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["tabs", "content.code.copy", "header.autohide"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>